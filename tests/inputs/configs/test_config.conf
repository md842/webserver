http {
  server { # HTTPS server using test frontend
    listen                8080 ssl;
    index                 small.html;
    root                  tests/inputs;

    ssl_certificate       tests/certs/localhost.crt;
    ssl_certificate_key   tests/certs/localhost.key;

    location ^~ /stopmod {
      try_files will_not_match =500;
    }

    location ^~ /stopmodifier {
      try_files will_not_match =418;
    }

    location /stopmodnone {
      try_files will_not_match =aaa;
    }

    location / {
      try_files $uri small.html; # React Router handles 404 by serving index
    }
  }
  server { # HTTP server using test frontend
    listen                8081;
    index                 small.html;
    root                  tests/inputs;
  }

  server { # Redirects from HTTP to HTTPS (expected result: 301 Moved Permanently)
    listen                8082;
    server_name           localhost;
    return                301 https://$host:8080$request_uri;
  }

  server { # Redirects from HTTP to HTTP via $scheme (expected result: 302 Found)
    listen                8083;
    server_name           localhost;
    return                302 $scheme://$host:8081$request_uri;
  }
}