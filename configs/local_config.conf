http {
  server {
    listen                8079;
    server_name           localhost;
    return                301 https://$host:8080$request_uri;
  }

  server {
    listen                8080 ssl;
    index                 index.html;
    root                  ../personal-website/build;

    server_name           localhost;

    ssl_certificate       tests/certs/localhost.crt;
    ssl_certificate_key   tests/certs/localhost.key;
    ssl_protocols         TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;
    ssl_ciphers           HIGH:!aNULL:!MD5;
    ssl_session_timeout   15m;

    location = / { # Check for exact match
      # React Router path; serve index
    }

    location = /health { # Check for exact match
      # Handled by HealthRequestHandler, but maybe put something here later.
    }

    location = /projects { # Check for exact match
      # React Router path; serve index
    }

    location = /projects/earth-impact-simulator { # Check for exact match
      # React Router path; serve index
    }

    location ^~ /projects/notebooks { # Longest prefix match
      # React Router path; serve index
    }

    location ^~ /projects/sim { # Longest prefix match
      # React Router path; serve index
    }

    location / { # Fallback
      try_files $uri index.html; # React Router handles 404 by serving index
    }
  }

  server {
    listen                8081;
    index                 index.html;
    root                  ../personal-website/build;

    location / {
      try_files $uri index.html; # React Router handles 404 by serving index
    }
  }

  server {
    listen                8082;
    server_name           localhost;
    return                $scheme://$host:8081$request_uri;
  }
}